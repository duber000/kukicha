# Tests for Kukicha Standard Library - Cast Package

petiole cast_test

import "stdlib/cast"
import "encoding/json"
import "testing"

# Test Atoi and ParseFloat wrappers
func TestBasicParsers(t reference testing.T)
    n, err := cast.Atoi("123")
    if err != empty
        t.Fatalf("Atoi failed: {err}")
    if n != 123
        t.Errorf("Expected 123, got {n}")

    f, err2 := cast.ParseFloat("3.14", 64)
    if err2 != empty
        t.Fatalf("ParseFloat failed: {err2}")
    if f == 0.0
        t.Errorf("ParseFloat returned zero for valid input")

# Test SmartInt conversions
func TestSmartInt(t reference testing.T)
    val, err := cast.SmartInt(5)
    if err != empty or val != 5
        t.Fatalf("SmartInt failed for int: {err}")
    val2, err2 := cast.SmartInt("7")
    if err2 != empty or val2 != 7
        t.Fatalf("SmartInt failed for string: {err2}")
    val3, err3 := cast.SmartInt(json.Number("9"))
    if err3 != empty or val3 != 9
        t.Fatalf("SmartInt failed for json.Number: {err3}")
    val4, err4 := cast.SmartInt(true)
    if err4 != empty or val4 != 1
        t.Fatalf("SmartInt failed for bool: {err4}")

# Test SmartFloat64 conversions
func TestSmartFloat64(t reference testing.T)
    val, err := cast.SmartFloat64(1.5)
    if err != empty or val != 1.5
        t.Fatalf("SmartFloat64 failed for float64: {err}")
    val2, err2 := cast.SmartFloat64("2.5")
    if err2 != empty or val2 == 0.0
        t.Fatalf("SmartFloat64 failed for string: {err2}")

# Test SmartBool and SmartString
func TestSmartBoolAndString(t reference testing.T)
    val, err := cast.SmartBool("true")
    if err != empty or not val
        t.Fatalf("SmartBool failed for string true: {err}")
    val2, err2 := cast.SmartBool(0)
    if err2 != empty or val2
        t.Fatalf("SmartBool failed for int zero: {err2}")

    str, err3 := cast.SmartString(10)
    if err3 != empty or str != "10"
        t.Fatalf("SmartString should convert int to string: {err3}")
    str2, err4 := cast.SmartString(empty)
    if err4 != empty or str2 != ""
        t.Fatalf("SmartString should handle empty value: {err4}")
