// Generated by Kukicha v0.0.1 (requires Go 1.25+)
//
// Performance options:
//   GOEXPERIMENT=greenteagc  - Green Tea GC (10-40% faster, default in Go 1.26)
//   GOEXPERIMENT=jsonv2      - Faster JSON parsing (2-10x improvement)

package must

import (
	"fmt"
	"github.com/duber000/kukicha/stdlib/env"
	"strconv"
)

func Do(value any, err error) any {
	if err != nil {
		panic(fmt.Sprintf("must: %v", err))
	}
	return value
}

func DoMsg(value any, err error, message string) any {
	if err != nil {
		panic(fmt.Sprintf("%v: %v", message, err))
	}
	return value
}

func Ok(err error) {
	if err != nil {
		panic(fmt.Sprintf("must: %v", err))
	}
}

func OkMsg(err error, message string) {
	if err != nil {
		panic(fmt.Sprintf("%v: %v", message, err))
	}
}

func Env(key string) string {
	value := env.GetOr(key, "")
	if value == "" {
		panic(fmt.Sprintf("must: environment variable %v is required but not set", key))
	}
	return value
}

func EnvOr(key string, defaultValue string) string {
	value := env.GetOr(key, "")
	if value == "" {
		return defaultValue
	}
	return value
}

func EnvInt(key string) int {
	value := env.GetOr(key, "")
	if value == "" {
		panic(fmt.Sprintf("must: environment variable %v is required but not set", key))
	}
	n, err := strconv.Atoi(value)
	if err != nil {
		panic(fmt.Sprintf("must: environment variable %v must be a valid integer, got '%v'", key, value))
	}
	return n
}

func EnvIntOr(key string, defaultValue int) int {
	value := env.GetOr(key, "")
	if value == "" {
		return defaultValue
	}
	n, err := strconv.Atoi(value)
	if err != nil {
		panic(fmt.Sprintf("must: environment variable %v must be a valid integer, got '%v'", key, value))
	}
	return n
}

func EnvBool(key string) bool {
	value := env.GetOr(key, "")
	if value == "" {
		panic(fmt.Sprintf("must: environment variable %v is required but not set", key))
	}
	result, err := env.ParseBool(value)
	if err != nil {
		panic(fmt.Sprintf("must: environment variable %v must be a valid boolean, got '%v'", key, value))
	}
	return result
}

func EnvBoolOr(key string, defaultValue bool) bool {
	value := env.GetOr(key, "")
	if value == "" {
		return defaultValue
	}
	result, err := env.ParseBool(value)
	if err != nil {
		panic(fmt.Sprintf("must: environment variable %v must be a valid boolean, got '%v'", key, value))
	}
	return result
}

func EnvList(key string, separator string) []string {
	value := env.GetOr(key, "")
	if value == "" {
		panic(fmt.Sprintf("must: environment variable %v is required but not set", key))
	}
	return env.SplitAndTrim(value, separator)
}

func EnvListOr(key string, separator string, defaultValue []string) []string {
	value := env.GetOr(key, "")
	if value == "" {
		return defaultValue
	}
	return env.SplitAndTrim(value, separator)
}

func True(condition bool, message string) {
	if !condition {
		panic(fmt.Sprintf("assertion failed: %v", message))
	}
}

func False(condition bool, message string) {
	if condition {
		panic(fmt.Sprintf("assertion failed: %v", message))
	}
}

func NotEmpty(s string, name string) {
	if s == "" {
		panic(fmt.Sprintf("%v cannot be empty", name))
	}
}

func NotNil(value any, name string) {
	if value == nil {
		panic(fmt.Sprintf("%v cannot be nil", name))
	}
}
