# Tests for Kukicha Standard Library - Netguard Package

petiole netguard_test

import "stdlib/netguard"
import "testing"

# Test Allow and Block guards
func TestAllowBlockGuards(t reference testing.T)
    allowGuard, err := netguard.NewAllow(list of string{"192.0.2.0/24"})
    if err != empty
        t.Fatalf("NewAllow failed: {err}")
    if not netguard.Check(allowGuard, "192.0.2.1")
        t.Errorf("Allow guard should permit addresses inside CIDR")
    if netguard.Check(allowGuard, "198.51.100.1")
        t.Errorf("Allow guard should deny addresses outside CIDR")

    blockGuard, err2 := netguard.NewBlock(list of string{"203.0.113.0/24"})
    if err2 != empty
        t.Fatalf("NewBlock failed: {err2}")
    if netguard.Check(blockGuard, "203.0.113.1")
        t.Errorf("Block guard should block listed CIDR")

# Test SSRF guard blocks private IPs
func TestSSRFGuard(t reference testing.T)
    guard := netguard.NewSSRFGuard()
    if netguard.Check(guard, "10.0.0.5")
        t.Errorf("SSRF guard should block private IPs")
