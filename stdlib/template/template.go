// Generated by Kukicha v0.0.1 (requires Go 1.25+)
//
// Performance options:
//   GOEXPERIMENT=greenteagc  - Green Tea GC (10-40% faster, default in Go 1.26)
//   GOEXPERIMENT=jsonv2      - Faster JSON parsing (2-10x improvement)

package template

import (
	"bytes"
	"text/template"
)

type TemplateData struct {
	Content string
	Data    map[string]any
}

func Render(tmplStr string) TemplateData {
	return TemplateData{Content: tmplStr, Data: make(map[string]any)}
}

func Data(td TemplateData, data map[string]any) TemplateData {
	td.Data = data
	return td
}

func Execute(td TemplateData) (string, error) {
	tmpl, err := template.New("template").Parse(td.Content)
	if err != nil {
		return "", err
	}
	buf := bytes.Buffer{}
	err = tmpl.Execute(&buf, td.Data)
	if err != nil {
		return "", err
	}
	return buf.String(), nil
}

func Parse(content string) TemplateData {
	return TemplateData{Content: content, Data: make(map[string]any)}
}

func New() TemplateData {
	return TemplateData{Content: "", Data: make(map[string]any)}
}

func WithContent(td TemplateData, content string) TemplateData {
	td.Content = content
	return td
}

func RenderSimple(tmplStr string, data map[string]any) (string, error) {
	tmpl, err := template.New("template").Parse(tmplStr)
	if err != nil {
		return "", err
	}
	buf := bytes.Buffer{}
	err = tmpl.Execute(&buf, data)
	if err != nil {
		return "", err
	}
	return buf.String(), nil
}

func Must(result string, err error) string {
	if err != nil {
		panic(err)
	}
	return result
}

func Funcs(td TemplateData, funcMap map[string]any) TemplateData {
	return td
}
