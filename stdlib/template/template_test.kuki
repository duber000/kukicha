# Tests for Kukicha Standard Library - Template Package

petiole template_test

import "stdlib/template"
import "stdlib/string"
import "testing"

# Test RenderSimple renders template with data
func TestRenderSimple(t reference testing.T)
    result, err := template.RenderSimple("Hello {{.Name}}", map of string to any{"Name": "Ari"})
    if err != empty
        t.Fatalf("RenderSimple failed: {err}")
    if result != "Hello Ari"
        t.Errorf("Expected greeting, got {result}")

# Test Execute renders template via builder pattern
func TestExecute(t reference testing.T)
    td := template.New()
    td = template.WithContent(td, "Greetings {{.Name}}!")
    td = template.Data(td, map of string to any{"Name": "Eve"})
    final, err := template.Execute(td)
    if err != empty
        t.Fatalf("Execute failed: {err}")
    if final != "Greetings Eve!"
        t.Errorf("Template pipeline produced wrong output")

# Test HTMLRenderSimple escapes HTML content
func TestHTMLRenderSimple(t reference testing.T)
    result, err := template.HTMLRenderSimple("<b>{{.Value}}</b>", map of string to any{"Value": "<script>"})
    if err != empty
        t.Fatalf("HTMLRenderSimple failed: {err}")
    if not string.Contains(result, "&lt;script&gt;")
        t.Errorf("Expected escaped content, got {result}")
