// Generated by Kukicha v0.0.1 (requires Go 1.25+)
//
// Performance options:
//   GOEXPERIMENT=greenteagc  - Green Tea GC (10-40% faster, default in Go 1.26)
//   GOEXPERIMENT=jsonv2      - Faster JSON parsing (2-10x improvement)

package result

import "errors"

type Optional struct {
	hasValue bool
	value    any
}

type Result struct {
	isOk  bool
	value any
	err   error
}

func Some(value any) Optional {
	return Optional{hasValue: true, value: value}
}

func None() Optional {
	return Optional{hasValue: false, value: nil}
}

func IsSome(opt Optional) bool {
	return opt.hasValue
}

func IsNone(opt Optional) bool {
	return !opt.hasValue
}

func Unwrap(opt Optional) any {
	if !opt.hasValue {
		panic("attempted to unwrap None value")
	}
	return opt.value
}

func UnwrapOr(opt Optional, defaultValue any) any {
	if opt.hasValue {
		return opt.value
	}
	return defaultValue
}

func Map(opt Optional, transform func(any) any) Optional {
	if !opt.hasValue {
		return opt
	}
	return Some(transform(opt.value))
}

func FlatMap(opt Optional, transform func(any) Optional) Optional {
	if !opt.hasValue {
		return None()
	}
	return transform(opt.value)
}

func Filter(opt Optional, predicate func(any) bool) Optional {
	if !opt.hasValue {
		return opt
	}
	if predicate(opt.value) {
		return opt
	}
	return None()
}

func Ok(value any) Result {
	return Result{isOk: true, value: value, err: nil}
}

func Err(err error) Result {
	return Result{isOk: false, value: nil, err: err}
}

func IsOk(res Result) bool {
	return res.isOk
}

func IsErr(res Result) bool {
	return !res.isOk
}

func UnwrapResult(res Result) any {
	if !res.isOk {
		panic("attempted to unwrap Err result")
	}
	return res.value
}

func UnwrapErr(res Result) error {
	if res.isOk {
		panic("attempted to unwrap error from Ok result")
	}
	return res.err
}

func UnwrapOrResult(res Result, defaultValue any) any {
	if res.isOk {
		return res.value
	}
	return defaultValue
}

func UnwrapOrElse(res Result, fn func() any) any {
	if res.isOk {
		return res.value
	}
	return fn()
}

func MapResult(res Result, transform func(any) any) Result {
	if !res.isOk {
		return res
	}
	return Ok(transform(res.value))
}

func MapErr(res Result, transform func(error) error) Result {
	if res.isOk {
		return res
	}
	return Err(transform(res.err))
}

func AndThen(res Result, fn func(any) Result) Result {
	if !res.isOk {
		return res
	}
	return fn(res.value)
}

func OrElse(res Result, fn func(error) Result) Result {
	if res.isOk {
		return res
	}
	return fn(res.err)
}

func Match(res Result, onOk func(any) any, onErr func(error) any) any {
	if res.isOk {
		return onOk(res.value)
	}
	return onErr(res.err)
}

func ToOptional(res Result) Optional {
	if res.isOk {
		return Some(res.value)
	}
	return None()
}

func FromOptional(opt Optional, err error) Result {
	if opt.hasValue {
		return Ok(opt.value)
	}
	return Err(err)
}

func Flatten(opt Optional) Optional {
	if !opt.hasValue {
		return None()
	}
	inner, ok := opt.value.(Optional)
	if ok {
		return inner
	}
	return opt
}

func FlattenResult(res Result) Result {
	if !res.isOk {
		return res
	}
	inner, ok := res.value.(Result)
	if ok {
		return inner
	}
	return res
}

func All(results []Result) Result {
	values := make([]any, 0)
	for _, res := range results {
		if !res.isOk {
			return res
		}
		values = append(values, res.value)
	}
	return Ok(values)
}

func Any(results []Result) Result {
	lastErr := errors.New("no results provided")
	for _, res := range results {
		if res.isOk {
			return res
		}
		lastErr = res.err
	}
	return Err(lastErr)
}
