// Generated by Kukicha v0.0.4 (requires Go 1.26+)
//
// Performance: GOEXPERIMENT=jsonv2 enables faster JSON parsing (2-10x improvement)

package ctx

import (
	"context"
	"time"
)

//line /var/home/tluker/repos/go/kukicha/stdlib/ctx/ctx.kuki:10
type Handle struct {
	ctx    context.Context
	cancel func()
}

//line /var/home/tluker/repos/go/kukicha/stdlib/ctx/ctx.kuki:15
func Background() Handle {
//line /var/home/tluker/repos/go/kukicha/stdlib/ctx/ctx.kuki:16
	return Handle{ctx: context.Background(), cancel: nil}
}

//line /var/home/tluker/repos/go/kukicha/stdlib/ctx/ctx.kuki:22
func WithTimeoutMs(parent Handle, timeoutMs int64) Handle {
//line /var/home/tluker/repos/go/kukicha/stdlib/ctx/ctx.kuki:23
	base := parent.ctx
//line /var/home/tluker/repos/go/kukicha/stdlib/ctx/ctx.kuki:24
	if base == nil {
//line /var/home/tluker/repos/go/kukicha/stdlib/ctx/ctx.kuki:25
		base = context.Background()
	}
//line /var/home/tluker/repos/go/kukicha/stdlib/ctx/ctx.kuki:26
	timeout := (time.Duration(timeoutMs) * time.Millisecond)
//line /var/home/tluker/repos/go/kukicha/stdlib/ctx/ctx.kuki:27
	child, cancel := context.WithTimeout(base, timeout)
//line /var/home/tluker/repos/go/kukicha/stdlib/ctx/ctx.kuki:28
	return Handle{ctx: child, cancel: cancel}
}

//line /var/home/tluker/repos/go/kukicha/stdlib/ctx/ctx.kuki:34
func WithDeadlineUnix(parent Handle, unixSeconds int64) Handle {
//line /var/home/tluker/repos/go/kukicha/stdlib/ctx/ctx.kuki:35
	base := parent.ctx
//line /var/home/tluker/repos/go/kukicha/stdlib/ctx/ctx.kuki:36
	if base == nil {
//line /var/home/tluker/repos/go/kukicha/stdlib/ctx/ctx.kuki:37
		base = context.Background()
	}
//line /var/home/tluker/repos/go/kukicha/stdlib/ctx/ctx.kuki:38
	deadline := time.Unix(unixSeconds, 0)
//line /var/home/tluker/repos/go/kukicha/stdlib/ctx/ctx.kuki:39
	child, cancel := context.WithDeadline(base, deadline)
//line /var/home/tluker/repos/go/kukicha/stdlib/ctx/ctx.kuki:40
	return Handle{ctx: child, cancel: cancel}
}

//line /var/home/tluker/repos/go/kukicha/stdlib/ctx/ctx.kuki:46
func Cancel(handle Handle) {
//line /var/home/tluker/repos/go/kukicha/stdlib/ctx/ctx.kuki:47
	if handle.cancel != nil {
//line /var/home/tluker/repos/go/kukicha/stdlib/ctx/ctx.kuki:48
		handle.cancel()
	}
}

//line /var/home/tluker/repos/go/kukicha/stdlib/ctx/ctx.kuki:51
func Done(handle Handle) bool {
//line /var/home/tluker/repos/go/kukicha/stdlib/ctx/ctx.kuki:52
	if handle.ctx == nil {
//line /var/home/tluker/repos/go/kukicha/stdlib/ctx/ctx.kuki:53
		return false
	}
//line /var/home/tluker/repos/go/kukicha/stdlib/ctx/ctx.kuki:54
	return (handle.ctx.Err() != nil)
}

//line /var/home/tluker/repos/go/kukicha/stdlib/ctx/ctx.kuki:57
func Err(handle Handle) error {
//line /var/home/tluker/repos/go/kukicha/stdlib/ctx/ctx.kuki:58
	if handle.ctx == nil {
//line /var/home/tluker/repos/go/kukicha/stdlib/ctx/ctx.kuki:59
		return nil
	}
//line /var/home/tluker/repos/go/kukicha/stdlib/ctx/ctx.kuki:60
	return handle.ctx.Err()
}

//line /var/home/tluker/repos/go/kukicha/stdlib/ctx/ctx.kuki:63
func Value(handle Handle) context.Context {
//line /var/home/tluker/repos/go/kukicha/stdlib/ctx/ctx.kuki:64
	if handle.ctx == nil {
//line /var/home/tluker/repos/go/kukicha/stdlib/ctx/ctx.kuki:65
		return context.Background()
	}
//line /var/home/tluker/repos/go/kukicha/stdlib/ctx/ctx.kuki:66
	return handle.ctx
}
