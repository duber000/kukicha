// Generated by Kukicha v0.0.5 (requires Go 1.26+)

package json

import (
	stdjson "encoding/json"
	"fmt"
	"io"
)

//line /var/home/tluker/repos/go/kukicha/stdlib/json/json.kuki:12
type Encoder struct {
	writer        io.Writer
	deterministic bool
	indent        string
	prefix        string
}

//line /var/home/tluker/repos/go/kukicha/stdlib/json/json.kuki:19
type Decoder struct {
	reader io.Reader
}

//line /var/home/tluker/repos/go/kukicha/stdlib/json/json.kuki:25
func NewEncoder(writer io.Writer) Encoder {
//line /var/home/tluker/repos/go/kukicha/stdlib/json/json.kuki:26
	enc := Encoder{}
//line /var/home/tluker/repos/go/kukicha/stdlib/json/json.kuki:27
	enc.writer = writer
//line /var/home/tluker/repos/go/kukicha/stdlib/json/json.kuki:28
	enc.deterministic = false
//line /var/home/tluker/repos/go/kukicha/stdlib/json/json.kuki:29
	enc.indent = ""
//line /var/home/tluker/repos/go/kukicha/stdlib/json/json.kuki:30
	enc.prefix = ""
//line /var/home/tluker/repos/go/kukicha/stdlib/json/json.kuki:31
	return enc
}

//line /var/home/tluker/repos/go/kukicha/stdlib/json/json.kuki:36
func WithDeterministic(enc Encoder) Encoder {
//line /var/home/tluker/repos/go/kukicha/stdlib/json/json.kuki:37
	enc.deterministic = true
//line /var/home/tluker/repos/go/kukicha/stdlib/json/json.kuki:38
	return enc
}

//line /var/home/tluker/repos/go/kukicha/stdlib/json/json.kuki:43
func WithIndent(enc Encoder, indent string) Encoder {
//line /var/home/tluker/repos/go/kukicha/stdlib/json/json.kuki:44
	enc.indent = indent
//line /var/home/tluker/repos/go/kukicha/stdlib/json/json.kuki:45
	return enc
}

//line /var/home/tluker/repos/go/kukicha/stdlib/json/json.kuki:49
func WithPrefix(enc Encoder, prefix string) Encoder {
//line /var/home/tluker/repos/go/kukicha/stdlib/json/json.kuki:50
	enc.prefix = prefix
//line /var/home/tluker/repos/go/kukicha/stdlib/json/json.kuki:51
	return enc
}

//line /var/home/tluker/repos/go/kukicha/stdlib/json/json.kuki:59
func Encode(enc Encoder, value any) error {
	// encoding/json v1 already sorts map keys deterministically; no special
	// handling needed for enc.deterministic.
//line /var/home/tluker/repos/go/kukicha/stdlib/json/json.kuki:61
	return stdjson.NewEncoder(enc.writer).Encode(value)
}

//line /var/home/tluker/repos/go/kukicha/stdlib/json/json.kuki:70
func NewDecoder(reader io.Reader) Decoder {
//line /var/home/tluker/repos/go/kukicha/stdlib/json/json.kuki:71
	dec := Decoder{}
//line /var/home/tluker/repos/go/kukicha/stdlib/json/json.kuki:72
	dec.reader = reader
//line /var/home/tluker/repos/go/kukicha/stdlib/json/json.kuki:73
	return dec
}

//line /var/home/tluker/repos/go/kukicha/stdlib/json/json.kuki:80
func Decode(dec Decoder, target any) error {
//line /var/home/tluker/repos/go/kukicha/stdlib/json/json.kuki:81
	return stdjson.NewDecoder(dec.reader).Decode(target)
}

//line /var/home/tluker/repos/go/kukicha/stdlib/json/json.kuki:88
func Marshal(value any) ([]byte, error) {
//line /var/home/tluker/repos/go/kukicha/stdlib/json/json.kuki:89
	bytes, err := stdjson.Marshal(value)
//line /var/home/tluker/repos/go/kukicha/stdlib/json/json.kuki:90
	return bytes, err
}

//line /var/home/tluker/repos/go/kukicha/stdlib/json/json.kuki:97
func MarshalPretty(value any) ([]byte, error) {
//line /var/home/tluker/repos/go/kukicha/stdlib/json/json.kuki:98
	bytes, err := stdjson.MarshalIndent(value, "", "  ")
//line /var/home/tluker/repos/go/kukicha/stdlib/json/json.kuki:99
	return bytes, err
}

//line /var/home/tluker/repos/go/kukicha/stdlib/json/json.kuki:108
func Unmarshal(data []byte, target any) error {
//line /var/home/tluker/repos/go/kukicha/stdlib/json/json.kuki:109
	return stdjson.Unmarshal(data, target)
}

//line /var/home/tluker/repos/go/kukicha/stdlib/json/json.kuki:115
func MarshalWrite(writer io.Writer, value any) error {
//line /var/home/tluker/repos/go/kukicha/stdlib/json/json.kuki:116
	return stdjson.NewEncoder(writer).Encode(value)
}

//line /var/home/tluker/repos/go/kukicha/stdlib/json/json.kuki:123
func UnmarshalRead(reader io.Reader, target any) error {
//line /var/home/tluker/repos/go/kukicha/stdlib/json/json.kuki:124
	return stdjson.NewDecoder(reader).Decode(target)
}

//line /var/home/tluker/repos/go/kukicha/stdlib/json/json.kuki:129
func DecodeRead[T any](reader io.Reader, sample T) (T, error) {
//line /var/home/tluker/repos/go/kukicha/stdlib/json/json.kuki:130
	data := sample
//line /var/home/tluker/repos/go/kukicha/stdlib/json/json.kuki:131
	if err_1 := stdjson.NewDecoder(reader).Decode(&data); err_1 != nil {
		err_1 = fmt.Errorf("failed to decode json: %w", err_1)
		return *new(T), err_1
	}
//line /var/home/tluker/repos/go/kukicha/stdlib/json/json.kuki:132
	return data, nil
}
