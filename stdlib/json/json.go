// Generated by Kukicha v0.0.10 (requires Go 1.26+)

package json

import (
	"encoding/json"
	"fmt"
	"io"
)

//line /home/user/kukicha/stdlib/json/json.kuki:10
type Encoder struct {
	writer        io.Writer
	deterministic bool
	indent        string
	prefix        string
}

//line /home/user/kukicha/stdlib/json/json.kuki:17
type Decoder struct {
	reader io.Reader
}

//line /home/user/kukicha/stdlib/json/json.kuki:23
func NewEncoder(writer io.Writer) Encoder {
//line /home/user/kukicha/stdlib/json/json.kuki:24
	enc := Encoder{}
//line /home/user/kukicha/stdlib/json/json.kuki:25
	enc.writer = writer
//line /home/user/kukicha/stdlib/json/json.kuki:26
	enc.deterministic = false
//line /home/user/kukicha/stdlib/json/json.kuki:27
	enc.indent = ""
//line /home/user/kukicha/stdlib/json/json.kuki:28
	enc.prefix = ""
//line /home/user/kukicha/stdlib/json/json.kuki:29
	return enc
}

//line /home/user/kukicha/stdlib/json/json.kuki:34
func WithDeterministic(enc Encoder) Encoder {
//line /home/user/kukicha/stdlib/json/json.kuki:35
	enc.deterministic = true
//line /home/user/kukicha/stdlib/json/json.kuki:36
	return enc
}

//line /home/user/kukicha/stdlib/json/json.kuki:41
func WithIndent(enc Encoder, indent string) Encoder {
//line /home/user/kukicha/stdlib/json/json.kuki:42
	enc.indent = indent
//line /home/user/kukicha/stdlib/json/json.kuki:43
	return enc
}

//line /home/user/kukicha/stdlib/json/json.kuki:47
func WithPrefix(enc Encoder, prefix string) Encoder {
//line /home/user/kukicha/stdlib/json/json.kuki:48
	enc.prefix = prefix
//line /home/user/kukicha/stdlib/json/json.kuki:49
	return enc
}

//line /home/user/kukicha/stdlib/json/json.kuki:56
func Encode(enc Encoder, value any) error {
//line /home/user/kukicha/stdlib/json/json.kuki:58
	encoder := json.NewEncoder(enc.writer)
//line /home/user/kukicha/stdlib/json/json.kuki:59
	return encoder.Encode(value)
}

//line /home/user/kukicha/stdlib/json/json.kuki:64
func NewDecoder(reader io.Reader) Decoder {
//line /home/user/kukicha/stdlib/json/json.kuki:65
	dec := Decoder{}
//line /home/user/kukicha/stdlib/json/json.kuki:66
	dec.reader = reader
//line /home/user/kukicha/stdlib/json/json.kuki:67
	return dec
}

//line /home/user/kukicha/stdlib/json/json.kuki:72
func Decode(dec Decoder, target any) error {
//line /home/user/kukicha/stdlib/json/json.kuki:73
	decoder := json.NewDecoder(dec.reader)
//line /home/user/kukicha/stdlib/json/json.kuki:74
	return decoder.Decode(target)
}

//line /home/user/kukicha/stdlib/json/json.kuki:79
func Marshal(value any) ([]byte, error) {
//line /home/user/kukicha/stdlib/json/json.kuki:80
	bytes, err := json.Marshal(value)
//line /home/user/kukicha/stdlib/json/json.kuki:81
	return bytes, err
}

//line /home/user/kukicha/stdlib/json/json.kuki:85
func MarshalPretty(value any) ([]byte, error) {
//line /home/user/kukicha/stdlib/json/json.kuki:86
	bytes, err := json.MarshalIndent(value, "", "  ")
//line /home/user/kukicha/stdlib/json/json.kuki:87
	return bytes, err
}

//line /home/user/kukicha/stdlib/json/json.kuki:92
func Unmarshal(data []byte, target any) error {
//line /home/user/kukicha/stdlib/json/json.kuki:93
	return json.Unmarshal(data, target)
}

//line /home/user/kukicha/stdlib/json/json.kuki:99
func MarshalWrite(writer io.Writer, value any) error {
//line /home/user/kukicha/stdlib/json/json.kuki:100
	encoder := json.NewEncoder(writer)
//line /home/user/kukicha/stdlib/json/json.kuki:101
	return encoder.Encode(value)
}

//line /home/user/kukicha/stdlib/json/json.kuki:107
func UnmarshalRead(reader io.Reader, target any) error {
//line /home/user/kukicha/stdlib/json/json.kuki:108
	decoder := json.NewDecoder(reader)
//line /home/user/kukicha/stdlib/json/json.kuki:109
	return decoder.Decode(target)
}

//line /home/user/kukicha/stdlib/json/json.kuki:114
func DecodeRead[T any](reader io.Reader, sample T) (T, error) {
//line /home/user/kukicha/stdlib/json/json.kuki:115
	data := sample
//line /home/user/kukicha/stdlib/json/json.kuki:116
	decoder := json.NewDecoder(reader)
//line /home/user/kukicha/stdlib/json/json.kuki:117
	if err_1 := decoder.Decode(&data); err_1 != nil {
		err_1 = fmt.Errorf("failed to decode json: %w", err_1)
		return *new(T), err_1
	}
//line /home/user/kukicha/stdlib/json/json.kuki:118
	return data, nil
}
