// Generated by Kukicha v0.0.3 (requires Go 1.26+)
//
// Performance: GOEXPERIMENT=jsonv2 enables faster JSON parsing (2-10x improvement)

package main

import (
	"fmt"
	"github.com/duber000/kukicha/stdlib/fetch"
	"github.com/duber000/kukicha/stdlib/json"
	"net/http"
)

//line /var/home/tluker/repos/go/kukicha/examples/fetch-repos/main.kuki:7
type Repo struct {
	ID          int    `json:"id"`
	Name        string `json:"name"`
	FullName    string `json:"full_name"`
	Description string `json:"description"`
	Stars       int    `json:"stargazers_count"`
	Language    string `json:"language"`
	URL         string `json:"html_url"`
}

//line /var/home/tluker/repos/go/kukicha/examples/fetch-repos/main.kuki:16
func main() {
//line /var/home/tluker/repos/go/kukicha/examples/fetch-repos/main.kuki:18
	repos := []Repo{}
//line /var/home/tluker/repos/go/kukicha/examples/fetch-repos/main.kuki:20
	if err_1 := json.Decode(json.NewDecoder(func() *http.Response {
		val, _ := fetch.CheckStatus(func() *http.Response { val, _ := fetch.Get("https://api.github.com/users/golang/repos"); return val }())
		return val
	}().Body), &repos); err_1 != nil {
		panic(fmt.Sprintf("Failed to fetch or parse repos: %v", err_1))
	}
//line /var/home/tluker/repos/go/kukicha/examples/fetch-repos/main.kuki:22
	fmt.Println(fmt.Sprintf("Successfully fetched %v repositories!", len(repos)))
//line /var/home/tluker/repos/go/kukicha/examples/fetch-repos/main.kuki:24
	for _, repo := range repos[:5] {
//line /var/home/tluker/repos/go/kukicha/examples/fetch-repos/main.kuki:25
		fmt.Println(fmt.Sprintf("- %v: %v stars (%v)", repo.Name, repo.Stars, repo.Language))
	}
}
