// Generated by Kukicha v1.0.0 (requires Go 1.25+)
//
// Performance options:
//   GOEXPERIMENT=greenteagc  - Green Tea GC (10-40% faster, default in Go 1.26)
//   GOEXPERIMENT=jsonv2      - Faster JSON parsing (2-10x improvement)

package main

import (
	"fmt"
	"github.com/duber000/kukicha/stdlib/cli"
	"github.com/duber000/kukicha/stdlib/shell"
)

func main() {
	app := cli.Action(cli.AddFlag(cli.Arg(cli.New("cli-demo"), "command", "Command to run (echo|ls|info)"), "verbose", "Enable verbose output", "false"), handleCommand)
	if err_1 := cli.RunApp(app); err_1 != nil {
		panic("command failed")
	}
}

func handleCommand(args cli.Args) {
	command := cli.GetString(args, "command")
	verbose := cli.GetBool(args, "verbose")
	if command == "" {
		fmt.Println("Usage: kukicha run examples/cli-demo/main.kuki <command>")
		fmt.Println("Commands: echo, ls, info")
		fmt.Println("Flags: --verbose")
		return
	}
	if verbose {
		fmt.Println("Verbose mode enabled")
	}
	if command == "echo" {
		fmt.Println("Hello from CLI!")
	} else if command == "ls" {
		if verbose {
			fmt.Println("Listing current directory")
		}
		cmd := shell.New("ls", "-la")
		result := shell.Execute(cmd)
		if shell.Success(result) {
			output := string(shell.GetOutput(result))
			fmt.Println(output)
		} else {
			errOutput := string(shell.GetError(result))
			fmt.Println(fmt.Sprintf("Error: %v", errOutput))
		}
	} else if command == "info" {
		fmt.Println("System Information:")
		cmd1 := shell.New("hostname")
		result1 := shell.Execute(cmd1)
		if shell.Success(result1) {
			hostname := string(shell.GetOutput(result1))
			fmt.Println(fmt.Sprintf("Hostname: %v", hostname))
		} else {
			fmt.Println("Hostname: unknown")
		}
		cmd2 := shell.New("pwd")
		result2 := shell.Execute(cmd2)
		if shell.Success(result2) {
			pwd := string(shell.GetOutput(result2))
			fmt.Println(fmt.Sprintf("Current Directory: %v", pwd))
		} else {
			fmt.Println("Current Directory: unknown")
		}
		if shell.Which("git") {
			fmt.Println("Git is installed")
		} else {
			fmt.Println("Git is not installed")
		}
	} else {
		fmt.Println(fmt.Sprintf("Unknown command: %v", command))
		fmt.Println("Available commands: echo, ls, info")
	}
}
