// Generated by Kukicha v0.0.4 (requires Go 1.26+)
//
// Performance: GOEXPERIMENT=jsonv2 enables faster JSON parsing (2-10x improvement)

package main

import (
	"fmt"
	"github.com/duber000/kukicha/stdlib/cast"
	"github.com/duber000/kukicha/stdlib/mcp"
	"os"
)

//line /var/home/tluker/repos/go/kukicha/examples/mcp_server.kuki:8
func add(args map[string]any) (any, error) {
//line /var/home/tluker/repos/go/kukicha/examples/mcp_server.kuki:10
	a, err_1 := cast.SmartInt(args["a"])
	if err_1 != nil {
		a = 0
	}
//line /var/home/tluker/repos/go/kukicha/examples/mcp_server.kuki:11
	b, err_2 := cast.SmartInt(args["b"])
	if err_2 != nil {
		b = 0
	}
//line /var/home/tluker/repos/go/kukicha/examples/mcp_server.kuki:13
	result := (a + b)
//line /var/home/tluker/repos/go/kukicha/examples/mcp_server.kuki:14
	res := fmt.Sprintf("%v + %v = %v", a, b, result)
//line /var/home/tluker/repos/go/kukicha/examples/mcp_server.kuki:15
	return any(res), nil
}

//line /var/home/tluker/repos/go/kukicha/examples/mcp_server.kuki:17
func main() {
//line /var/home/tluker/repos/go/kukicha/examples/mcp_server.kuki:19
	server := mcp.New("Kukicha Example", "1.0.0")
//line /var/home/tluker/repos/go/kukicha/examples/mcp_server.kuki:22
	props := []mcp.SchemaProperty{mcp.Prop("a", "number", "The first number"), mcp.Prop("b", "number", "The second number")}
//line /var/home/tluker/repos/go/kukicha/examples/mcp_server.kuki:23
	addSchema := mcp.Schema(props)
//line /var/home/tluker/repos/go/kukicha/examples/mcp_server.kuki:24
	addSchema = mcp.Required(addSchema, []string{"a", "b"}).(map[string]any)
//line /var/home/tluker/repos/go/kukicha/examples/mcp_server.kuki:27
	mcp.Tool(server, "add", "Add two numbers", addSchema, add)
//line /var/home/tluker/repos/go/kukicha/examples/mcp_server.kuki:30
	fmt.Fprintln(os.Stderr, "MCP Server starting...")
//line /var/home/tluker/repos/go/kukicha/examples/mcp_server.kuki:33
	err := mcp.Serve(server)
//line /var/home/tluker/repos/go/kukicha/examples/mcp_server.kuki:34
	if err != nil {
//line /var/home/tluker/repos/go/kukicha/examples/mcp_server.kuki:35
		fmt.Fprintln(os.Stderr, fmt.Sprintf("Server finished with error: %v", err))
	}
}
